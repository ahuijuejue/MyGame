--[[
世界树商店
]]

local ShopScene = import(".ShopScene")
local ShopTreeScene = class("ShopTreeScene", ShopScene)


function ShopTreeScene:initView()
	ShopTreeScene.super.initView(self)

	-- 按钮层
	app:createView("widget.MenuLayer", {wealth="tree"}):addTo(self):zorder(10)
	:onBack(function(layer)
		app:popScene()
	end)

-------------------------------------------------------
-- 侧边按钮
	-- 普通商店
	CommonButton.sidebar("普通")
	:addTo(self.layer_)
	:pos(885, 420)
	:onTouch(function(event)
		if event.name == "clicked" then
			CommonSound.click() -- 音效

		    SceneData:enterScene("ShopNormal", self)
		end
	end)

	-- 积分商店
	CommonButton.sidebar("积分")
	:addTo(self.layer_)
	:pos(885, 345)
	:onTouch(function(event)
		if event.name == "clicked" then
			CommonSound.click() -- 音效
			print("enter score")
		    SceneData:enterScene("ShopScore", self)
		end
	end)

	-- 艾恩葛朗特商店
	self.aincradBtn = CommonButton.sidebar("葛朗特")
	:addTo(self.layer_)
	:pos(885, 270)
	:onClicked(function(event)
		CommonSound.click() -- 音效
	    SceneData:enterScene("ShopAincrad", self)
	end)

	-- 世界树商店
	CommonButton.sidebar("世界树")
	:addTo(self.layer_)
	:pos(885, 195)
	:zorder(5)
	:setSelected(true)

	-- 公会商店
	self.unionBtn = CommonButton.sidebar("公会")
	:addTo(self.layer_)
	:pos(885, 120)
	:onClicked(function(event)
		CommonSound.click() -- 音效
	    SceneData:enterScene("ShopUnion", self)
	end)

end

function ShopTreeScene:updateData()
	ShopTreeScene.super.updateData(self)

	self.data = ShopList:getShop("tree")
end

function ShopTreeScene:updateView()
	ShopTreeScene.super.updateView(self)

	self.aincradBtn:setVisible(AincradData:isAincradOpen())
	if UserData.unionId then
		self.unionBtn:setVisible(UserData.unionId ~= "")
	else
		self.unionBtn:setVisible(false)
	end
end

-- 商店 到时间 刷新了 的检测
function ShopTreeScene:autoRefreshListenerName()
	return "refresh_shop_tree"
end

return ShopTreeScene
